# Source: https://git.openwrt.org/?p=openwrt/openwrt.git;a=blob;f=package/boot/uboot-mvebu/patches/102-arm-mvebu-add-support-for-MikroTik-RB5009UG-S-IN.patch;h=950e9357555c3645137b12294173d709351f381e;hb=HEAD

openwrt_initramfs=openwrt-mvebu-cortexa72-mikrotik_rb5009-initramfs-uImage.itb
boot_devices=ubi usb net
recovery_boot_devices=usb net

button_cmd_0_name=reset
button_cmd_0=run recovery_bootcmd

recovery_bootcmd=
	led green:sfp on;
	led blue:hdr1 on;
	led blue:hdr2 on;

	for b in ${recovery_boot_devices}; do
		if test ${b} = usb; then
			run usbboot;
		fi;
		if test ${b} = net; then
			run netboot;
		fi;
	done;

bootcmd=
	for b in ${boot_devices}; do
		if test ${b} = ubi; then
			run ubiboot;
		fi;
		if test ${b} = usb; then
			run usbboot;
		fi;
		if test ${b} = net; then
			run netboot;
		fi;
	done;

ubiboot=
	echo Booting from NAND (UBI);
	ubi part ubi;
	setenv loadimagecmd ${ubiloadimage};
	ubi read ${loadaddr} kernel;
	bootm ${loadaddr};

usbboot=
	echo Booting from USB Storage;
	usb start;
	load usb 0:1 ${loadaddr} ${openwrt_initramfs};
	bootm ${loadaddr};

netboot=
	echo Booting from Network;
	dhcp;
	tftpboot ${loadaddr} ${openwrt_initramfs};
	bootm ${loadaddr};